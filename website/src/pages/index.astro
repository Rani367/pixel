---
import BaseLayout from '../layouts/BaseLayout.astro';

const description = "Pixel is a free, beginner-friendly programming language for making 2D games. Simple syntax, built-in game engine, sprites, physics, and audio. No setup required - runs on Windows, Mac, Linux, and web browsers.";
const keywords = ["Pixel programming language", "Pixel game engine", "2D game programming language", "beginner game development", "learn game programming", "simple game engine", "kids coding language", "educational game programming", "free game engine", "easy game development"];
---

<BaseLayout description={description} keywords={keywords}>
  <!-- 3D Background Canvas (decorative) -->
  <canvas id="pixel-bg" class="fixed inset-0 -z-10 pointer-events-none" aria-hidden="true"></canvas>

  <!-- Hero Section -->
  <section class="py-20 md:py-32 relative">
    <div class="max-w-6xl mx-auto px-4 text-center">
      <h1 class="text-4xl md:text-6xl font-bold tracking-tight mb-6">
        Pixel: 2D Game Development Made Simple
      </h1>
      <p class="text-xl text-zinc-600 dark:text-zinc-400 max-w-2xl mx-auto mb-10">
        A beginner-friendly programming language with a built-in game engine.
        Create games in minutes, not months.
      </p>
      <div class="flex flex-wrap justify-center gap-4 mb-16">
        <a
          href="/pixel/docs"
          class="px-6 py-3 bg-cyan-400 text-zinc-900 font-medium rounded-lg hover:bg-cyan-500 transition-colors"
        >
          Get Started
        </a>
        <a
          href="/pixel/playground"
          class="px-6 py-3 border border-zinc-300 dark:border-zinc-700 font-medium rounded-lg hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors"
        >
          Try Online
        </a>
      </div>

      <!-- Code Example -->
      <div id="code-zoom" class="max-w-2xl mx-auto text-left" style="transform-origin: center top; transition: transform 0.1s ease-out;">
        <div class="bg-zinc-900 rounded-lg overflow-hidden shadow-2xl">
          <div class="flex items-center gap-2 px-4 py-3 bg-zinc-800">
            <span class="w-3 h-3 rounded-full bg-red-500"></span>
            <span class="w-3 h-3 rounded-full bg-yellow-500"></span>
            <span class="w-3 h-3 rounded-full bg-green-500"></span>
            <span class="ml-2 text-sm text-zinc-400">game.pixel</span>
          </div>
          <pre class="p-6 text-sm leading-relaxed overflow-x-auto"><code class="text-zinc-300"><span class="text-purple-400">function</span> <span class="text-cyan-400">on_start</span>() {'{'}
    <span class="text-cyan-400">create_window</span>(<span class="text-orange-400">800</span>, <span class="text-orange-400">600</span>, <span class="text-green-400">"My Game"</span>)
    player = <span class="text-cyan-400">create_sprite</span>(<span class="text-cyan-400">load_image</span>(<span class="text-green-400">"hero.png"</span>))
    player.x = <span class="text-orange-400">400</span>
{'}'}

<span class="text-purple-400">function</span> <span class="text-cyan-400">on_update</span>(dt) {'{'}
    <span class="text-purple-400">if</span> <span class="text-cyan-400">key_down</span>(KEY_RIGHT) {'{'}
        player.x = player.x + <span class="text-orange-400">200</span> * dt
    {'}'}
{'}'}

<span class="text-purple-400">function</span> <span class="text-cyan-400">on_draw</span>() {'{'}
    <span class="text-cyan-400">clear</span>(<span class="text-cyan-400">rgb</span>(<span class="text-orange-400">20</span>, <span class="text-orange-400">20</span>, <span class="text-orange-400">40</span>))
    <span class="text-cyan-400">draw_sprite</span>(player)
{'}'}</code></pre>
        </div>
      </div>
    </div>
  </section>

  <!-- Features Section -->
  <section class="py-16 bg-zinc-50 dark:bg-zinc-900">
    <div class="max-w-6xl mx-auto px-4">
      <div class="grid md:grid-cols-3 gap-8">
        <div class="p-6">
          <div class="w-12 h-12 bg-[--color-accent]/10 rounded-lg flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-[--color-accent]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-2">Simple Syntax</h3>
          <p class="text-zinc-600 dark:text-zinc-400">
            Easy to learn syntax inspired by Python. Write readable code without boilerplate.
          </p>
        </div>

        <div class="p-6">
          <div class="w-12 h-12 bg-[--color-accent]/10 rounded-lg flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-[--color-accent]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-2">Built-in Engine</h3>
          <p class="text-zinc-600 dark:text-zinc-400">
            Sprites, animations, physics, audio, and input handling included. No external libraries needed.
          </p>
        </div>

        <div class="p-6">
          <div class="w-12 h-12 bg-[--color-accent]/10 rounded-lg flex items-center justify-center mb-4">
            <svg class="w-6 h-6 text-[--color-accent]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-2">Runs Anywhere</h3>
          <p class="text-zinc-600 dark:text-zinc-400">
            Build for Windows, macOS, Linux, and the web. One codebase, multiple platforms.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Install Section -->
  <section class="py-16">
    <div class="max-w-6xl mx-auto px-4">
      <h2 class="text-2xl font-bold text-center mb-8">Quick Start</h2>
      <div class="max-w-xl mx-auto">
        <div class="bg-zinc-900 rounded-lg p-6">
          <div class="space-y-2 font-mono text-sm">
            <p class="text-zinc-400"># Install Pixel (one command)</p>
            <p class="text-zinc-100">$ <span class="text-green-400">curl -fsSL https://raw.githubusercontent.com/Rani367/pixel/main/scripts/install.sh | bash</span></p>
            <p class="text-zinc-400 mt-4"># Run your first game</p>
            <p class="text-zinc-100">$ <span class="text-green-400">pixel game.pixel</span></p>
          </div>
        </div>
        <p class="text-center mt-4 text-sm text-zinc-600 dark:text-zinc-400">
          See <a href="/pixel/docs/installation" class="text-[--color-accent] hover:underline">installation guide</a> for all options.
        </p>
      </div>
    </div>
  </section>

  <!-- Three.js for 3D background -->
  <script is:inline src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

  <script is:inline>
    // Code zoom scroll effect
    const codeZoom = document.getElementById('code-zoom');

    function updateZoom() {
      if (!codeZoom) return;

      const rect = codeZoom.getBoundingClientRect();
      const viewportHeight = window.innerHeight;

      const startPoint = viewportHeight;
      const endPoint = viewportHeight * 0.3;
      const currentPoint = rect.top;

      let progress = (startPoint - currentPoint) / (startPoint - endPoint);
      progress = Math.max(0, Math.min(1, progress));

      const scale = 0.75 + (progress * 0.5);
      codeZoom.style.transform = `scale(${scale})`;
    }

    window.addEventListener('scroll', updateZoom, { passive: true });
    window.addEventListener('resize', updateZoom);
    updateZoom();

    // Interactive 3D Pixel Background
    (function() {
      const canvas = document.getElementById('pixel-bg');
      if (!canvas || typeof THREE === 'undefined') return;

      // Scene setup
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
      camera.position.z = 30;

      const renderer = new THREE.WebGLRenderer({
        canvas,
        alpha: true,
        antialias: true,
        powerPreference: 'high-performance'
      });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

      // Check dark mode
      const isDark = () => document.documentElement.classList.contains('dark');

      // Pixel cube colors - cyan accent theme
      const colors = [
        0x00d4ff, // Primary cyan
        0x00b8e6, // Darker cyan
        0x00f0ff, // Lighter cyan
        0x7dd3fc, // Sky blue
        0x22d3ee, // Teal
        0x06b6d4, // Cyan 500
      ];

      // Create pixel cubes
      const cubes = [];
      const cubeCount = 80;

      for (let i = 0; i < cubeCount; i++) {
        const size = Math.random() * 0.8 + 0.3;
        const geometry = new THREE.BoxGeometry(size, size, size);

        const color = colors[Math.floor(Math.random() * colors.length)];
        const material = new THREE.MeshBasicMaterial({
          color,
          transparent: true,
          opacity: Math.random() * 0.4 + 0.1
        });

        const cube = new THREE.Mesh(geometry, material);

        // Random position in a wide field
        cube.position.x = (Math.random() - 0.5) * 60;
        cube.position.y = (Math.random() - 0.5) * 40;
        cube.position.z = (Math.random() - 0.5) * 30 - 10;

        // Random rotation
        cube.rotation.x = Math.random() * Math.PI;
        cube.rotation.y = Math.random() * Math.PI;

        // Store velocity for animation
        cube.userData = {
          rotationSpeed: {
            x: (Math.random() - 0.5) * 0.01,
            y: (Math.random() - 0.5) * 0.01,
            z: (Math.random() - 0.5) * 0.005
          },
          floatSpeed: Math.random() * 0.5 + 0.2,
          floatOffset: Math.random() * Math.PI * 2,
          originalY: cube.position.y
        };

        scene.add(cube);
        cubes.push(cube);
      }

      // Add some wireframe cubes for extra depth
      for (let i = 0; i < 20; i++) {
        const size = Math.random() * 1.5 + 0.5;
        const geometry = new THREE.BoxGeometry(size, size, size);
        const edges = new THREE.EdgesGeometry(geometry);
        const material = new THREE.LineBasicMaterial({
          color: 0x00d4ff,
          transparent: true,
          opacity: Math.random() * 0.2 + 0.05
        });

        const wireframe = new THREE.LineSegments(edges, material);

        wireframe.position.x = (Math.random() - 0.5) * 70;
        wireframe.position.y = (Math.random() - 0.5) * 50;
        wireframe.position.z = (Math.random() - 0.5) * 20 - 15;

        wireframe.rotation.x = Math.random() * Math.PI;
        wireframe.rotation.y = Math.random() * Math.PI;

        wireframe.userData = {
          rotationSpeed: {
            x: (Math.random() - 0.5) * 0.008,
            y: (Math.random() - 0.5) * 0.008,
            z: (Math.random() - 0.5) * 0.004
          },
          floatSpeed: Math.random() * 0.3 + 0.1,
          floatOffset: Math.random() * Math.PI * 2,
          originalY: wireframe.position.y
        };

        scene.add(wireframe);
        cubes.push(wireframe);
      }

      // Mouse tracking for parallax
      let mouseX = 0;
      let mouseY = 0;
      let targetMouseX = 0;
      let targetMouseY = 0;

      document.addEventListener('mousemove', (e) => {
        targetMouseX = (e.clientX / window.innerWidth - 0.5) * 2;
        targetMouseY = (e.clientY / window.innerHeight - 0.5) * 2;
      });

      // Animation loop
      let time = 0;
      function animate() {
        requestAnimationFrame(animate);
        time += 0.01;

        // Smooth mouse following
        mouseX += (targetMouseX - mouseX) * 0.05;
        mouseY += (targetMouseY - mouseY) * 0.05;

        // Animate cubes
        cubes.forEach((cube) => {
          const data = cube.userData;

          // Rotation
          cube.rotation.x += data.rotationSpeed.x;
          cube.rotation.y += data.rotationSpeed.y;
          cube.rotation.z += data.rotationSpeed.z;

          // Floating motion
          cube.position.y = data.originalY + Math.sin(time * data.floatSpeed + data.floatOffset) * 0.5;
        });

        // Camera parallax based on mouse
        camera.position.x += (mouseX * 3 - camera.position.x) * 0.02;
        camera.position.y += (-mouseY * 2 - camera.position.y) * 0.02;
        camera.lookAt(scene.position);

        renderer.render(scene, camera);
      }

      // Handle resize
      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });

      // Update colors based on theme
      const updateTheme = () => {
        const dark = isDark();
        cubes.forEach((cube) => {
          if (cube.material) {
            // Slightly adjust opacity based on theme
            const baseOpacity = cube.material.opacity;
            cube.material.opacity = dark ? baseOpacity : baseOpacity * 0.7;
          }
        });
      };

      // Watch for theme changes
      const observer = new MutationObserver(updateTheme);
      observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class']
      });

      updateTheme();
      animate();
    })();
  </script>
</BaseLayout>
